<a href="chats.html">Chats</a>
<a href="newbubble.html">New Bubble</a>
<a href="nearby.html">Nearby</a>
<a href="profile.html">Profile</a>


<h2>My Bubbles</h2>

<input type="button" value="Get Bubbles" onclick="getbubbles();"/>

<div id="bubbles"></div>


<script>
	const url = "https://api.bubble-network.com/";

	function bubble(b) {
		return `<div>
			<a href="bubble.html?bubbleid=${b.BubbleId}">${b.Name}</a>
			<strong>Participants: </strong>${b.Participants.join(", ")}
			<strong>Owner: </strong>${b.Owner}
			<strong>Description: </strong>${b.Description}
			<strong>Thickness: </strong>${b.Thickness}
			<strong>Location: </strong>${b.Center.Coordinates.toString()}
			<strong>Radius: </strong>${b.Radius}
		</div>`
	}

	function getbubbles() {
		const request = new Request(
			url + "bubbles?type=user",
			{ credentials: "include" }
		);
		fetch(request).then(res => {
			if(res.status == 200) {
				let bubbles = document.getElementById("bubbles");

				// Get bubbles
				res.json().then(bs => {
					bs.map(b => {
						let bEl = document.createElement("div");
						bEl.textContent = bubble(b);
						document.getElementById('bubbles').append(bEl);
					});
				});
			} else {
				res.text().then(v => alert(v));
			}
		}).catch(e => console.log(e));
	}

</script>

